bootstrap: docker
From: continuumio/miniconda3

%post

## Prepare Conda
## ----------

## Add conda to path.

export PATH=$PATH:/opt/conda/bin

## Update conda.

conda update -n base -y -c defaults conda

## Install Conda Environment
## ----------

## Create environment.

conda create -n stripe-seq-analysis -y -c conda-forge -c bioconda \
r-tidyverse \
r-devtools \
r-eulerr \
r-ggseqlogo \
r-gtools \
r-cairo \
bioconductor-genomicranges \
bioconductor-genomicfeatures \
bioconductor-biostrings \
bioconductor-rsamtools \
bioconductor-rtracklayer \
bioconductor-chipseeker \
bioconductor-gviz \
bioconductor-edger \
bioconductor-tsrchitect

## Update environment.

conda update -n stripe-seq-analysis -y -c conda-forge -c bioconda --all

## Clean up extra files.

conda clean -y --all

## Add stripe-saturation software to path

export PATH=/opt/conda/envs/stripe-seq-analysis/bin:$PATH

## Install latest build of TSRchitect

R --slave -e 'Sys.setenv(TAR="/bin/tar");devtools::install_github("BrendelGroup/TSRchitect",ref="master")'

%environment

## Add software to environment

export PATH=/opt/conda/envs/stripe-seq-analysis/bin:$PATH
